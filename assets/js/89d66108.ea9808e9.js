"use strict";(self.webpackChunkgrid_docs=self.webpackChunkgrid_docs||[]).push([[4611],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=a,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||i;return n?r.createElement(h,o(o({ref:t},p),{},{components:n})):r.createElement(h,o({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},308:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return p},default:function(){return u}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],s={title:"Credentials",sidebar_label:"Credentials"},l="Grid Credentials",c={unversionedId:"platform/credentials",id:"platform/credentials",title:"Credentials",description:"Credentials are secret values that you can use to securely inject sensitive information into the",source:"@site/docs/platform/3_credentials.md",sourceDirName:"platform",slug:"/platform/credentials",permalink:"/platform/credentials",editUrl:"https://github.com/gridai/grid-docs/edit/master/docs/platform/3_credentials.md",tags:[],version:"current",lastUpdatedAt:1657900930,formattedLastUpdatedAt:"7/15/2022",sidebarPosition:3,frontMatter:{title:"Credentials",sidebar_label:"Credentials"},sidebar:"tutorialSidebar",previous:{title:"FAQ",permalink:"/platform/Custom Cloud Credentials/faq"},next:{title:"Machines",permalink:"/platform/machines"}},p=[{value:"Access to Secrets (Teams Users)",id:"access-to-secrets-teams-users",children:[],level:3},{value:"Credential Types",id:"credential-types",children:[],level:3},{value:"How to Create an <code>s3</code> Credential for Private S3 Access (BYOC users only)",id:"how-to-create-an-s3-credential-for-private-s3-access-byoc-users-only",children:[],level:2},{value:"Prerequisite: Configure IAM Role in AWS",id:"prerequisite-configure-iam-role-in-aws",children:[{value:"0. Change from deault cluster context",id:"0-change-from-deault-cluster-context",children:[],level:3},{value:"1. Generate Trust and Permission Policiess",id:"1-generate-trust-and-permission-policiess",children:[],level:3},{value:"2. Add Trust and Permission Policies to AWS",id:"2-add-trust-and-permission-policies-to-aws",children:[],level:3},{value:"3. Create AWS Role Name",id:"3-create-aws-role-name",children:[],level:3},{value:"4. Input role ARN in Grid",id:"4-input-role-arn-in-grid",children:[],level:3}],level:2}],d={toc:p};function u(e){var t=e.components,s=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"grid-credentials"},"Grid Credentials"),(0,i.kt)("p",null,"Credentials are secret values that you can use to securely inject sensitive information into the\nGrid platform. Credentials are encrypted in the Grid-backend storage\nsystems and are only decrypted immediately prior to use."),(0,i.kt)("h3",{id:"access-to-secrets-teams-users"},"Access to Secrets (Teams Users)"),(0,i.kt)("p",null,"Credentials can be created by any Grid user, with a limit of 50\nCredentials per account. Only the user who created a credential (the owner) can\ndelete that credential. All of the user's team members are able to utilize the credential in\ntheir own workflow (for example, while creating a Datastore from a private s3 bucket)."),(0,i.kt)("p",null,"Sensitive credential type values can never be retrieved from Grid via the CLI. However,\nthe values of non-sensitive credential types (such as ",(0,i.kt)("inlineCode",{parentName:"p"},"--type s3"),") can be viewed by the user\nwho created the credential and any member of the user's team (for our ",(0,i.kt)("inlineCode",{parentName:"p"},"teams")," tier users.)"),(0,i.kt)("h3",{id:"credential-types"},"Credential Types"),(0,i.kt)("p",null,"At the moment, the following credential types are supported:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"s3")," (access for datastore creation from a private s3 bucket)")),(0,i.kt)("h2",{id:"how-to-create-an-s3-credential-for-private-s3-access-byoc-users-only"},"How to Create an ",(0,i.kt)("inlineCode",{parentName:"h2"},"s3")," Credential for Private S3 Access (BYOC users only)"),(0,i.kt)("p",null,"Grid now supports the ability to create Datastores from private AWS s3 buckets by using\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"--no-copy")," mode via the CLI. In order to allow Grid to access your private buckets,\nyou'll need to create an authorized AWS Role using the ",(0,i.kt)("inlineCode",{parentName:"p"},"grid credential create --type s3"),"\ncommand (explained in detail below). After creating a role, you can run the\n",(0,i.kt)("inlineCode",{parentName:"p"},"grid datastore create S3://<private-bucket-name-here> --no-copy")," command as usual - no\nmodifications needed. If any of your registered ",(0,i.kt)("inlineCode",{parentName:"p"},"s3")," credentials can access the s3 bucket\npath specified, then Grid will automatically use them when creating the Datastore (and\nwhen using that Datastore in a ",(0,i.kt)("inlineCode",{parentName:"p"},"run")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"session"),")."),(0,i.kt)("h2",{id:"prerequisite-configure-iam-role-in-aws"},"Prerequisite: Configure IAM Role in AWS"),(0,i.kt)("p",null,"In order to provide Grid access to a private S3 bucket, you must first set up an AWS IAM Role configured with the appropriate permission policy. This is the absolute minimum permission Grid requires in order to list and retrieve files from an s3 bucket of your choice. The ",(0,i.kt)("inlineCode",{parentName:"p"},"grid credential create")," command will dynamically generate the IAM Role Trust Policy based on the cluster on which you are creating the Datastore. While all users will need to authorize the AWS account ID on which the Grid Platform controlplane runs, ",(0,i.kt)("a",{parentName:"p",href:"/platform/Custom%20Cloud%20Credentials/byoc"},"bring-your-own-cloud (",(0,i.kt)("inlineCode",{parentName:"a"},"BYOC"),") users")," will also need to include the AWS account ID on which the ",(0,i.kt)("inlineCode",{parentName:"p"},"BYOC")," cluster runs. "),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Please refer to the AWS documentation on ",(0,i.kt)("a",{parentName:"p",href:"https://aws.amazon.com/blogs/security/how-to-use-trust-policies-with-iam-roles/"},"IAM Role Trust\nPolicies"),"\nand ",(0,i.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html"},"IAM Role Permission\nPolicies")," for more\ndetailed information."))),(0,i.kt)("p",null,"We will illustrate the process of registering an IAM Role with Grid using the following\nexample:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"I want to run an experiment or session using sensitive data contained in a private s3 bucket. The bucket's name is\n",(0,i.kt)("inlineCode",{parentName:"p"},"gridai-demo-bucket")," and I would like to create a Datastore from any file\nprefix (folder) in the bucket. ")),(0,i.kt)("div",{style:{textAlign:"center"}},(0,i.kt)("p",null,(0,i.kt)("img",{src:n(3833).Z}))),(0,i.kt)("h3",{id:"0-change-from-deault-cluster-context"},"0. Change from deault cluster context"),(0,i.kt)("p",null,"By default the ",(0,i.kt)("a",{parentName:"p",href:"/platform/Custom%20Cloud%20Credentials/grid-cluster-context"},"cluster context")," is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"Grid Cloud"),". Change this to your BYOC cluster you created. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"grid user set-cluster-context <byoc cluster name>\n")),(0,i.kt)("h3",{id:"1-generate-trust-and-permission-policiess"},"1. Generate Trust and Permission Policiess"),(0,i.kt)("p",null,"First: run the ",(0,i.kt)("inlineCode",{parentName:"p"},"grid credential create --type s3")," command in order to find the required trust and\npermission policies. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ grid credential create --type s3\nPlease refer the the the documentation for how to create an AWS role and \npermission policy.\n\nThe trust policy for the role should be:\n{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": "sts:AssumeRole",\n      "Principal": {\n        "AWS": "302180240179"\n      },\n      "Condition": {\n        "StringEquals": {\n          "sts:ExternalId": "6aa0ae3592534df8936b03f4b73294c4"\n        }\n      }\n    }\n  ]\n}\n\nThe permission policy attached to the role should be:\n{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": [\n        "s3:GetBucketLocation",\n        "s3:GetObject",\n        "s3:ListBucket"\n      ],\n      "Resource": [\n        "arn:aws:s3:::<replace-with-bucket-name>",\n        "arn:aws:s3:::<replace-with-bucket-name>/*"\n      ]\n    }\n  ]\n}\n\nPlease be sure to change the <replace-with-bucket-name> field with the bucket \nname you wish to grant access to. More information can be found on the docs.\n\nPlease Note: when creating the role name in the AWS console, the role name MUST \nbegin with the prefix: grid-s3-access- any valid characters can follow the \nprefix.\n\nWhen complete, please enter the role ARN:\n')),(0,i.kt)("h3",{id:"2-add-trust-and-permission-policies-to-aws"},"2. Add Trust and Permission Policies to AWS"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"grid credential create")," command will output the required trust and permission policies. "),(0,i.kt)("p",null,"  a. Leave the command prompt open while visiting the ",(0,i.kt)("a",{parentName:"p",href:"https://us-east-1.console.aws.amazon.com/iamv2/home?region=us-east-1#/roles"},"AWS IAM Role\nConsole")," "),(0,i.kt)("p",null,'  b. Click "Create Role"'),(0,i.kt)("p",null,"  ",(0,i.kt)("img",{src:n(5969).Z})),(0,i.kt)("p",null,'  c. Select the "custom trust policy" setting, and copy/paste the trust policy output\nfrom the CLI into the ',(0,i.kt)("inlineCode",{parentName:"p"},"json")," editor:"),(0,i.kt)("p",null,"  ",(0,i.kt)("img",{src:n(5886).Z})),(0,i.kt)("p",null,'  d.  When prompted with the "add permissions to role" tab, click "Create Policy" to  create a new permission\npolicy'),(0,i.kt)("p",null,"  ",(0,i.kt)("img",{src:n(8355).Z})),(0,i.kt)("p",null,"  e.  A new tab will open. Select the ",(0,i.kt)("inlineCode",{parentName:"p"},"json")," tab, and\ncopy/paste the permission policy into the editor. Also replace the text\n",(0,i.kt)("inlineCode",{parentName:"p"},"<replace-with-bucket-name>")," with the name of the private bucket to provide access to\n(i.e. ",(0,i.kt)("inlineCode",{parentName:"p"},"gridai-demo-bucket"),"). "),(0,i.kt)("p",null,"  ",(0,i.kt)("img",{src:n(6911).Z})),(0,i.kt)("p",null,'  f. Click "next" until reaching the "permission policy naming" tab. Enter an appropriate\nname, for example: ',(0,i.kt)("inlineCode",{parentName:"p"},"my-permission-policy-for-grid"),". "),(0,i.kt)("p",null,"  ",(0,i.kt)("img",{src:n(3267).Z})),(0,i.kt)("p",null,'  g. Click "create policy".'),(0,i.kt)("p",null,"  ",(0,i.kt)("img",{src:n(1552).Z})),(0,i.kt)("p",null,"  h. Go back to the previous tab for attaching a permission policy to the role "),(0,i.kt)("p",null,"  i. Refresh the list of policies by clicking the refresh symbol"),(0,i.kt)("p",null,"  j. Select the ",(0,i.kt)("inlineCode",{parentName:"p"},"my-permission-policy-for-grid"),' policy name and click "next".'),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(6603).Z})),(0,i.kt)("h3",{id:"3-create-aws-role-name"},"3. Create AWS Role Name"),(0,i.kt)("p",null,'I then navigate through the prompts until I am presented with the "role naming" screen. At\nthis point, I create a role name ',(0,i.kt)("strong",{parentName:"p"},"keeping in mind that the role must begin with the\nprefix: ",(0,i.kt)("inlineCode",{parentName:"strong"},"grid-s3-access-")),". In this case I name the role\n",(0,i.kt)("inlineCode",{parentName:"p"},"grid-s3-access-for-my-demo-bucket")," and click create."),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(5961).Z})),(0,i.kt)("p",null,"I am then presented with a success screen! The role has been created. "),(0,i.kt)("h3",{id:"4-input-role-arn-in-grid"},"4. Input role ARN in Grid"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(6750).Z})),(0,i.kt)("p",null,'I select the role and click on the icon next to the "role ARN" in order to\ncopy the value to my clipboard:'),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(3623).Z})),(0,i.kt)("p",null,"I now go back to the terminal and paste my clipboard value into the input field\nI am being presented with:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"...\n...\n...\nWhen complete, please enter the role ARN: arn:aws:iam::880213070634:role/grid-s3-access-for-my-demo-bucket\n\nSuccess!\n")),(0,i.kt)("p",null,"The role has been successfully added, and I can see it in the list when I run ",(0,i.kt)("inlineCode",{parentName:"p"},"grid\ncredentials")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"grid credentials list"),". "),(0,i.kt)("p",null,"I can now run the regular command to create a Datastore and it will\nautomatically pick the correct credential and create the Datastore from my private s3 bucket!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ grid datastore create s3://gridai-demo-bucket/ --no-copy\nSuccess!\n")))}u.isMDXComponent=!0},8355:function(e,t,n){t.Z=n.p+"assets/images/add_permissions_to_role-467988e7744e2fc23bafb41a4025b36b.png"},3623:function(e,t,n){t.Z=n.p+"assets/images/arn_copy-f5960b958e0546d81206064971c4244f.png"},6603:function(e,t,n){t.Z=n.p+"assets/images/attach_permission_policy-4c4072dfefa498ef07a676f9ebb45e5e.png"},6911:function(e,t,n){t.Z=n.p+"assets/images/aws_permission_policy-b827f5ad506cdf38b2b18a8bc4130808.png"},3833:function(e,t,n){t.Z=n.p+"assets/images/demo_bucket_contents-f76693f0dfcc8ca298bcbc7a90ec32c3.png"},1552:function(e,t,n){t.Z=n.p+"assets/images/permission_policy_created-b1ef97ef4b95fbae84069d4a70ed209a.png"},3267:function(e,t,n){t.Z=n.p+"assets/images/permission_policy_naming-61bc156a0fa2a3a35a7344ab8797998e.png"},5969:function(e,t,n){t.Z=n.p+"assets/images/role-console-99180c36c0980a3c41ccfc017eb9b2c7.png"},6750:function(e,t,n){t.Z=n.p+"assets/images/role_created-10c9646383e79a9d4e8b5c680796996f.png"},5961:function(e,t,n){t.Z=n.p+"assets/images/role_naming-bec1799c7de7084b5f9faa84dcee7140.png"},5886:function(e,t,n){t.Z=n.p+"assets/images/select_trusted_entity-f4b9b5369083e7adb3d5b13351f8625f.png"}}]);