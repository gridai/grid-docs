"use strict";(self.webpackChunkgrid_docs=self.webpackChunkgrid_docs||[]).push([[2066],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return p}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=c(a),p=r,g=h["".concat(l,".").concat(p)]||h[p]||d[p]||i;return a?n.createElement(g,o(o({ref:t},u),{},{components:a})):n.createElement(g,o({ref:t},u))}));function p(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},3663:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return h}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),o=["components"],s={title:"High-Performance Datastores",sidebar_label:"High-Performance Datastores"},l="Introduction",c={unversionedId:"features/datastores/Using Datastores/high-performance-datastores",id:"features/datastores/Using Datastores/high-performance-datastores",title:"High-Performance Datastores",description:"High Performance Datastores (HPDs) allow Grid BYOC customers who are looking to scale large datasets to optimize latency and significantly speed up data access. Currently, HPDs are backed by the FSx for Lustre service and offer more scalability and higher throughput than conventional Grid Datastores backed by AWS S3.",source:"@site/docs/features/datastores/2_Using Datastores/7_high-performance-datastores.md",sourceDirName:"features/datastores/2_Using Datastores",slug:"/features/datastores/Using Datastores/high-performance-datastores",permalink:"/features/datastores/Using Datastores/high-performance-datastores",editUrl:"https://github.com/gridai/grid-docs/edit/master/docs/features/datastores/2_Using Datastores/7_high-performance-datastores.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"High-Performance Datastores",sidebar_label:"High-Performance Datastores"},sidebar:"tutorialSidebar",previous:{title:"Deleting Datastores",permalink:"/features/datastores/Using Datastores/deleting-datastores"},next:{title:"FAQ",permalink:"/features/datastores/faq"}},u=[{value:"Setting HPD Capacity",id:"setting-hpd-capacity",children:[],level:3},{value:"Setting HPD Throughput",id:"setting-hpd-throughput",children:[],level:3},{value:"Enabling data preloading",id:"enabling-data-preloading",children:[],level:3},{value:"Updating HPDs",id:"updating-hpds",children:[],level:3},{value:"Deleting HPDs",id:"deleting-hpds",children:[],level:3}],d={toc:u};function h(e){var t=e.components,a=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"High Performance Datastores (HPDs) allow Grid BYOC customers who are looking to scale large datasets to optimize latency and significantly speed up data access. Currently, HPDs are backed by the FSx for Lustre service and offer more scalability and higher throughput than conventional Grid Datastores backed by AWS S3."),(0,i.kt)("h1",{id:"advantages--limitations"},"Advantages & Limitations"),(0,i.kt)("p",null,"Using High Performance Datastores when processing very large datasets provides several significant benefits:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Higher data scalability:")," HPDs can scale up to 64 terabytes of data while maintaining high performance regardless of the file distribution within the datastore. This is especially relevant when a dataset contains many smaller files: while conventional Grid Datastores have nearly unlimited scale with regards to data volume, their performance is reduced when accessing datasets with millions or tens of millions of files."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Improved performance for single-user sessions:")," Up to 6x performance against conventional Datastores when used by a single client. This performance improvement may vary depending on the workload and instance type chosen, as HPDs are still accessed through the network."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Higher multi-consumer scalability:")," HPDs can be used by a larger number of concurrent experiments or sessions."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Automatic updating:")," An HPD will automatically update its contents to track the underlying S3 bucket data.")),(0,i.kt)("p",null,"Given their immense benefit to performance, HPDs with high performance specs can cost up to several thousand dollars per month. For reference, a baseline HPDS datastore in the ",(0,i.kt)("inlineCode",{parentName:"p"},"us-east")," AWS region\nwith a maximum capacity of 1.2TiB will cost 174","\\","$ per month, while a 12TiB datastore with the high throughput setting will cost 7200","\\","$ per month. For detailed pricing, please refer to the AWS pricing page: ",(0,i.kt)("a",{parentName:"p",href:"https://aws.amazon.com/fsx/lustre/pricing/"},"https://aws.amazon.com/fsx/lustre/pricing/")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Additionally, HPDs can only be provisioned by utilizing a pre-existing S3 bucket that is owned by the same AWS account in which your BYOC cluster is located. This requires additional configuration by your cluster administrator to enable access to specific S3 buckets.")),(0,i.kt)("h1",{id:"configuring-access"},"Configuring Access"),(0,i.kt)("p",null,"Once this feature has been enabled for your BYOC cluster, you will need to provide access to the corresponding S3 buckets for which you'd like to create a High Performance Datastore. This process requires that you add a bucket policy for each bucket you wish to access."),(0,i.kt)("p",null,"You can do this via the AWS webui or the CLI:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If you\u2019re using the AWS webui head to the S3 service at ",(0,i.kt)("a",{parentName:"p",href:"https://s3.console.aws.amazon.com/s3/buckets"},"https://s3.console.aws.amazon.com/s3/buckets"),', select the desired bucket, click on the permissions tab and select "Edit" on the bucket policy field to add the new policy.')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If you\u2019re using the AWS CLI, simply create a file containing this policy and then use the following command: "))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"aws s3api put-bucket-policy --bucket <YOUR_BUCKET_NAME> --policy file://policy.json")),(0,i.kt)("p",null,"The policy to add should be the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{\n  "Statement": [{\n    "Sid": "localdev-access-permissions",\n    "Effect": "Allow",\n    "Principal": {\n      "AWS": "arn:aws:iam::<YOUR_AWS_ACCOUNT_ID>:role/grid-s3-access-<YOUR_CLUSTER_NAME>-fsx-global-role"\n    },\n    "Action": [\n      "s3:AbortMultipartUpload",\n      "s3:DeleteObject",\n      "s3:PutObject",\n      "s3:Get*",\n      "s3:List*",\n      "s3:PutBucketNotification",\n      "s3:PutBucketPolicy",\n      "s3:DeleteBucketPolicy"\n    ],\n    "Resource": [\n      "arn:aws:s3:::<YOUR_BUCKET_NAME>",\n      "arn:aws:s3:::<YOUR_BUCKET_NAME>/*"\n    ]\n  }]\n}\n')),(0,i.kt)("h1",{id:"creating-high-performance-datastores"},"Creating High-Performance Datastores"),(0,i.kt)("p",null,"After configuring access, you can create a High Performance Datastore by passing the ",(0,i.kt)("inlineCode",{parentName:"p"},"--hpd")," flag to the CLI when executing the ",(0,i.kt)("inlineCode",{parentName:"p"},"grid datastore create")," command. "),(0,i.kt)("p",null,"For example: ",(0,i.kt)("inlineCode",{parentName:"p"},"grid datastore create s3://my-s3-bucket/ --cluster my-byoc-cluster --hpd")),(0,i.kt)("p",null,"This will create the Datastore using the default capacity of 1200GiB and the default throughput of 125MB/s/TiB. After a brief wait (between 15 minutes and 2 hours depending on the number of files in your S3 bucket), the Datastore will be available to use. You can monitor the Datastore state normally by using the grid datastore command."),(0,i.kt)("h3",{id:"setting-hpd-capacity"},"Setting HPD Capacity"),(0,i.kt)("p",null,"If your dataset is larger than 1200GiB you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--hpd-capacity")," flag to specify a higher capacity up to 64,800GiB. Note that capacity must be 1200, 2400 or a multiple of 2400."),(0,i.kt)("h3",{id:"setting-hpd-throughput"},"Setting HPD Throughput"),(0,i.kt)("p",null,"If you\u2019re going to be using your Datastore with a high number (>20) of experiments or sessions at the same time, you can also specify a higher throughput parameter by using the ",(0,i.kt)("inlineCode",{parentName:"p"},"--hpd-throughput")," flag. You may choose between the low (125MB/s/TiB), medium (500MB/s/TiB) or high (1000MB/s/TiB) options."),(0,i.kt)("p",null,"Do note that on single-instance usage (e.g., for a single experiment or session), the higher throughput options have heavily diminishing returns (especially as these Datastores can burst to speeds higher than their nominal throughput for sustained periods). In these cases, we advise using the low option in order to reduce costs. "),(0,i.kt)("h3",{id:"enabling-data-preloading"},"Enabling data preloading"),(0,i.kt)("p",null,"For cases where immediate access to the datastore is not required, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--hpd-preload")," flag to instruct Grid to automatically load and cache all data from the S3 bucket to the datastore. This ensures that you will have maximum performance even on the first data access (Without this flag, the first data access for any file will be done at conventional datastore speed). This process may take from a few minutes to a few hours or even more for very high volume datastores and while its ongoing you will not be able to access data in the datastore."),(0,i.kt)("p",null,"We suggest using this flag when you're going to traverse the entire datastore for a low number of iterations or when the additional time this process takes will not affect your workflow."),(0,i.kt)("h1",{id:"using-high-performance-datastores"},"Using High-Performance Datastores"),(0,i.kt)("p",null,"To use an HPD, simply attach it to an experiment or session in the same way as any other kind of datastore. Similar to conventional datastores, HPDs can be attached to multiple experiments or sessions at the same time."),(0,i.kt)("h3",{id:"updating-hpds"},"Updating HPDs"),(0,i.kt)("p",null,"Currently, updating an HPD to use a different capacity or throughput is not possible. You can create multiple versions of HPDs, but because each Datastore is automatically updated to track the underlying S3 bucket, this means that all versions will have the same content. They will, however, use different FSx file systems, and thus incur higher costs. For this reason, maintaining multiple versions of HPDs is not advised unless you specifically need each Datastore to be completely performance independent from the others."),(0,i.kt)("h3",{id:"deleting-hpds"},"Deleting HPDs"),(0,i.kt)("p",null,"Deleting an HPD can be done with grid datastore delete as with any conventional Datastore. You do not incur any charges for failed or deleted HPDs."))}h.isMDXComponent=!0}}]);