"use strict";(self.webpackChunkgrid_docs=self.webpackChunkgrid_docs||[]).push([[5569],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),u=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(r),m=a,g=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return r?n.createElement(g,i(i({ref:t},c),{},{components:r})):n.createElement(g,i({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=r[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},8303:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(7294),a=r(6010),o={note:n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},n.createElement("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})),tip:n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},n.createElement("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})),danger:n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},n.createElement("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})),info:n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},n.createElement("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})),caution:n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},n.createElement("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))},i={note:"secondary",tip:"success",danger:"danger",info:"info",caution:"warning"};function l(e){var t=e.children,r=e.type,l=e.title,s=void 0===l?r:l,u=e.icon,c=void 0===u?o[r]:u;return n.createElement("div",{className:(0,a.Z)("admonition","admonition-"+r,"alert","alert--"+i[r])},n.createElement("div",{className:"admonition-heading"},n.createElement("h5",null,n.createElement("span",{className:"admonition-icon"},c),s)),n.createElement("div",{className:"admonition-content"},t))}var s="admonition_heading_BIf6",u=function(e){return n.createElement("div",{className:s},n.createElement(l,{type:"info",title:"Note"},"\xa0\xa0",n.createElement("b",null,e.children)))}},2424:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return s},contentTitle:function(){return u},metadata:function(){return c},toc:function(){return d},default:function(){return m}});var n=r(7462),a=r(3366),o=(r(7294),r(3905)),i=r(8303),l=["components"],s={},u="Deploying Customer Managed Bring Your Own Cluster (BYOC) Mode",c={unversionedId:"platform/custom-cloud-credentials/customer-managed-byoc",id:"platform/custom-cloud-credentials/customer-managed-byoc",title:"Deploying Customer Managed Bring Your Own Cluster (BYOC) Mode",description:'To request access to this feature send an email to support@grid.ai with the subject "Request Access to BYOC Feature".',source:"@site/docs/platform/custom-cloud-credentials/customer-managed-byoc.md",sourceDirName:"platform/custom-cloud-credentials",slug:"/platform/custom-cloud-credentials/customer-managed-byoc",permalink:"/platform/custom-cloud-credentials/customer-managed-byoc",editUrl:"https://github.com/gridai/grid-docs/edit/master/docs/platform/custom-cloud-credentials/customer-managed-byoc.md",tags:[],version:"current",lastUpdatedAt:1648072548,formattedLastUpdatedAt:"3/23/2022",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"adding-custom-cloud-credentials",permalink:"/platform/custom-cloud-credentials/adding-custom-cloud-credentials"},next:{title:"Setting Cluster Context",permalink:"/platform/custom-cloud-credentials/grid-cluster-context"}},d=[{value:"Amazon Web Services (AWS)",id:"amazon-web-services-aws",children:[{value:"Requirements",id:"requirements",children:[{value:"Requesting Quotas",id:"requesting-quotas",children:[],level:4}],level:3},{value:"Step 1: Get AWS credentials",id:"step-1-get-aws-credentials",children:[],level:3},{value:"Step 2: Add IAM permissions to your account",id:"step-2-add-iam-permissions-to-your-account",children:[],level:3},{value:"Step 3: Create Role &amp; Policy grid requires",id:"step-3-create-role--policy-grid-requires",children:[{value:"Set Up",id:"set-up",children:[],level:4}],level:3},{value:"Step 4: Register your role in grid",id:"step-4-register-your-role-in-grid",children:[],level:3},{value:"Step 5: Wait for cluster to be provisioned",id:"step-5-wait-for-cluster-to-be-provisioned",children:[],level:3},{value:"Step 6: Run your workloads in your new cluster",id:"step-6-run-your-workloads-in-your-new-cluster",children:[],level:3},{value:"Step 7: Enjoy!",id:"step-7-enjoy",children:[],level:3}],level:2},{value:"Editing and Deleting Clusters",id:"editing-and-deleting-clusters",children:[],level:2}],p={toc:d};function m(e){var t=e.components,s=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,n.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"deploying-customer-managed-bring-your-own-cluster-byoc-mode"},"Deploying Customer Managed Bring Your Own Cluster (BYOC) Mode"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"To request access to this feature send an email to ",(0,o.kt)("a",{parentName:"p",href:"mailto:support@grid.ai"},"support@grid.ai"),' with the subject "Request Access to BYOC Feature".'))),(0,o.kt)("h2",{id:"amazon-web-services-aws"},"Amazon Web Services ","(","AWS",")"),(0,o.kt)("h3",{id:"requirements"},"Requirements"),(0,o.kt)("p",null,"Grid will create clusters designed for large AI workloads. However, the product is versatile and can handle other workloads. We recommend testing small workloads with Grid first in cost-savings mode. You can always transition to performance mode later if quicker startup times are desired for Grid features. Your AWS account needs to have the ",(0,o.kt)("strong",{parentName:"p"},"right permissions")," and ",(0,o.kt)("strong",{parentName:"p"},"quotas"),", in order for Grid to create clusters on your behalf. We'll cover both optional and required configurations as follows."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Configuration"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Recommendation"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Auto Scaling groups per region"),(0,o.kt)("td",{parentName:"tr",align:"left"},"800")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Launch configurations per region"),(0,o.kt)("td",{parentName:"tr",align:"left"},"600")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"EC2 Spot ","(","instance family you are interested in",")"),(0,o.kt)("td",{parentName:"tr",align:"left"},"1000+")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"EC2 On-demand ","(","instance family you are interested in",")"),(0,o.kt)("td",{parentName:"tr",align:"left"},"1000+")))),(0,o.kt)("h4",{id:"requesting-quotas"},"Requesting Quotas"),(0,o.kt)("p",null,'All AWS accounts have "service quotas". These are limits for the utilization of service provided by AWS. In order to increase your quotas, you have to request a quota increase to a specific service. That will open a ticket with AWS support. You may need to follow-up on the ticket in order for the quota to be granted.'),(0,o.kt)("p",null,"You can request a quota by doing"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Login into your AWS console"),(0,o.kt)("li",{parentName:"ol"},'Search for "',(0,o.kt)("a",{parentName:"li",href:"https://console.aws.amazon.com/servicequotas/home"},"Service Quotas"),'" and click on the result'),(0,o.kt)("li",{parentName:"ol"},"Click on the area of the service ","(",'e.g. "Amazon Elastic Compute Cloud ',"(","Amazon EC2",")",'"',")"),(0,o.kt)("li",{parentName:"ol"},"Use the search filter to find the quota that you are looking for"),(0,o.kt)("li",{parentName:"ol"},"Make a quota request")),(0,o.kt)("h3",{id:"step-1-get-aws-credentials"},"Step 1: Get AWS credentials"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"A: Login to AWS and search for IAM")),(0,o.kt)("p",null,'Login into your AWS account. You will then use the search bar to find "IAM" ',"(","user management",")","."),(0,o.kt)("p",null,(0,o.kt)("img",{src:r(3462).Z})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},'B: Click on "Users"')),(0,o.kt)("p",null,'Click on the "Users" panel. You will be able to see a list of users. If you already have a user, click on your user name. If you don\'t, move to the next step to create a new user.'),(0,o.kt)("p",null,(0,o.kt)("img",{src:r(9744).Z})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"C: Create New User ","(","optional",")")),(0,o.kt)("p",null,'If you don\'t have a user available and would like to create one, on the "Users" page click on "Add user". Fill in the user name of your preference and make sure to check "Programmatic access" ',"(","this allows you to use AWS keys",")","."),(0,o.kt)("p",null,(0,o.kt)("img",{src:r(6073).Z})),(0,o.kt)("p",null,'Click on "Next: Permissions" ',">"),(0,o.kt)("p",null,"The user can be given AdministratorAccess priveleges as the user is only used to provision the AWS infrastructure needed by Grid. Grid itself will use a limited permission set."),(0,o.kt)("p",null,'Click on "Next: Tags" ',">",' "Next: Review" ',">",' "Create user".'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"D: Create New AWS Keys")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},'Navigate to the "Users" page'),(0,o.kt)("li",{parentName:"ol"},"Click on your user name"),(0,o.kt)("li",{parentName:"ol"},'Click on the tab "Security Credentials"'),(0,o.kt)("li",{parentName:"ol"},'Click on "Create access key"'),(0,o.kt)("li",{parentName:"ol"},'Copy both the "Access key ID" and the "Secret access key" values')),(0,o.kt)(i.Z,{mdxType:"Note"},'The "Secret access key" value will only be shown once. Make sure you copy that value and store it in a safe location.'),(0,o.kt)("p",null,"Make sure that your user name has the right policies attached in order to user Grid correctly. Refer to the section ",(0,o.kt)("a",{parentName:"p",href:"/platform/custom-cloud-credentials/adding-custom-cloud-credentials#step-2-add-iam-permissions-to-your-account"},"Adding Grid AWS Policies & Roles")," for more details."),(0,o.kt)("h3",{id:"step-2-add-iam-permissions-to-your-account"},"Step 2: Add IAM permissions to your account"),(0,o.kt)("p",null,"The user you just created, and fetched credentials for should have AdministratorAccess privileges."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Reach out to us via ",(0,o.kt)("a",{parentName:"p",href:"slack:gridai-community.slack.com"},"Slack")," or ",(0,o.kt)("a",{parentName:"p",href:"mailto:support@grid.ai"},"email")," if you have any issues creating the following AWS roles and policies. We're happy to help!"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Add Policies to Your Account")),(0,o.kt)("p",null,"The final step is to add all the necessary permissions to your account to provision the necessary infrastructure. Customer-managed BYOC infrastructure Mode you own your infrastructure provisioning."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"First, log in to AWS and navigate to IAM"),(0,o.kt)("li",{parentName:"ol"},'Click on "Users"'),(0,o.kt)("li",{parentName:"ol"},"On the user's page, find your user name and click on it"),(0,o.kt)("li",{parentName:"ol"},'Click on "Add permissions"'),(0,o.kt)("li",{parentName:"ol"},'Click on "Attach existing policies directly"')),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Granting permissions to an user.",src:r(4377).Z})),(0,o.kt)("h3",{id:"step-3-create-role--policy-grid-requires"},"Step 3: Create Role & Policy grid requires"),(0,o.kt)("p",null,"For the next step you're going to create role we're going to assume into. For this you'll be using terraform. Make sure you have ",(0,o.kt)("inlineCode",{parentName:"p"},"git"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"jq")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"AWS CLI")," installed on your machine. Installation instruction of these tools are ",(0,o.kt)("a",{parentName:"p",href:"/platform/custom-cloud-credentials/adding-custom-cloud-credentials#prerequisites"},"available"),"."),(0,o.kt)(i.Z,{mdxType:"Note"},"Customer-managed BYOC Infrastructure Mode only gives Grid the following permissions:"),'* "eks:\\*", # only for the cluster it creates * "s3:\\*", # only for the buckets it creates',(0,o.kt)("h4",{id:"set-up"},"Set Up"),(0,o.kt)("p",null,"This version allows you to customize our terraform module to create your own BYOC infrastructure and set appropriate configurations for it via exposed variables ",(0,o.kt)("strong",{parentName:"p"},"Make sure your AWS CLI is properly configured with ",(0,o.kt)("a",{parentName:"strong",href:"/platform/custom-cloud-credentials/adding-custom-cloud-credentials#d-create-new-aws-keys"},"id & secret you created"),".  These are not shared with Grid.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"#Clone the repo\ngit clone https://github.com/gridai/terraform-aws-grid-byoc-full.git\ncd terraform-aws-grid-byoc-full\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"unset AWS_ACCESS_KEY_ID\nunset AWS_SECRET_ACCESS_KEY\nunset AWS_SESSION_TOKEN\naws configure\n# prompt and example entries below\nAWS Access Key ID [None]: xxxxxxxxx\nAWS Secret Access Key [None]: xxxxxxxxx\nDefault region name [None]:\nDefault output format [None]:\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Verify AWS Access Key")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'aws sts get-caller-identity\n# example entries below should match the above steps\n{\n    "UserId": "xxxxxxxxx",\n    "Account": "xxxxxxxxx",\n    "Arn": "arn:aws:iam::xxxxxxxxx:user/xxxxxxxxx"\n}\n')),(0,o.kt)("p",null,"We advise performing the following steps before continuing deployment"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Copy nmiculinic.tfvars from terraform-aws-grid-byoc-full/example"),(0,o.kt)("li",{parentName:"ol"},"Update the cluster and hostname cluster_name. For example:",(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},'  - cluster_name = "foo-01"\n  - hostname    = "foo-01.doom.gridai.dev"\n')),(0,o.kt)("em",{parentName:"li"},'It is recommended to run "grid clusters" and make sure that the cluster_name in the .tfvars file you are using does not match an existing name cluster name. Else you will receive an error.')),(0,o.kt)("li",{parentName:"ol"},"Set:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},'role_arn = ""'),(0,o.kt)("li",{parentName:"ul"},"testing_cluster = false"),(0,o.kt)("li",{parentName:"ul"},"guard_duty_integration = false"),(0,o.kt)("li",{parentName:"ul"},'builder_ami_name_override = ""'),(0,o.kt)("li",{parentName:"ul"},'bastion_ami_override = ""')))),(0,o.kt)("p",null,"Run the Terraform script and enter the AWS Region when prompted. The region where the VPC is located is entered during the in the ",(0,o.kt)("a",{parentName:"p",href:"/platform/custom-cloud-credentials/adding-custom-cloud-credentials#step-4-register-your-role-in-grid"},"later step.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform init\nterraform apply -var-file <your modified version of nmiculinic.tfvars>\n")),(0,o.kt)("p",null,"Copy the output from the last command. The following code snippets may help you copy the output to your clipboard:"),(0,o.kt)("p",null,"Linux"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform output -json | jq -r '.gridv1_cluster.value' | tee /dev/stderr |xsel -ib\n")),(0,o.kt)("p",null,"Mac:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform output -json | jq -r '.gridv1_cluster.value' | tee /dev/stderr | pbcopy\n")),(0,o.kt)("p",null,"Alternatively, if those commands do not work you can manually copy the output by running the below command. By default terraform hides the sensitive secret output."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"terraform output -json | jq -r '.gridv1_cluster.value'\n")),(0,o.kt)("h3",{id:"step-4-register-your-role-in-grid"},"Step 4: Register your role in grid"),(0,o.kt)("p",null,"By default, Grid Sessions and Runs are spun up in Availability Zone ",(0,o.kt)("inlineCode",{parentName:"p"},"a")," currently. Only specify the AWS region and not the AZ in the ",(0,o.kt)("inlineCode",{parentName:"p"},"--region")," argument."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Login to Grid.  Please reference the detailed ",(0,o.kt)("a",{parentName:"li",href:"/getting-started/#login-steps"},"steps")," as required.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"pip install lightning_grid --upgrade\ngrid login --username <Grid user name> --key <Grid API Key>\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create cluster in default region with default instance types."),(0,o.kt)("li",{parentName:"ul"},"Cluster name must be lower case alphanumeric characters, '-' or '.' is allowed but not '","_","', and must start and end with an alphanumeric character")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"grid clusters aws <name> --role-arn <doesn't matter> --external-id <doesn't matter> --edit-before-creation\n")),(0,o.kt)("p",null,"In edit paste the terraform output field you've just copied."),(0,o.kt)("h3",{id:"step-5-wait-for-cluster-to-be-provisioned"},"Step 5: Wait for cluster to be provisioned"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"grid clusters\n")),(0,o.kt)("p",null,"And wait for your cluster status be ",(0,o.kt)("inlineCode",{parentName:"p"},"running"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 id                 \u2503 name               \u2503 status  \u2503\n\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\n\u2502 grid-cloud-prod    \u2502 grid-cloud-prod    \u2502 running \u2502\n\u2502 <cluster name>     \u2502 <cluster name>     \u2502 running \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,o.kt)("p",null,"It can take some time to provision a new cluster, ~20-30 minutes"),(0,o.kt)("h3",{id:"step-6-run-your-workloads-in-your-new-cluster"},"Step 6: Run your workloads in your new cluster"),(0,o.kt)("p",null,"At this point you can update your cluster context so Grid runs commands against your new BYOC cluster by default. To do so run the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"grid user set-cluster-context <cluster-name>\n")),(0,o.kt)("p",null,"Now you can run workloads against your cluster as you normally would against grid-cloud-prod."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"grid run --cluster <cluster name>\ngrid session create --cluster <cluster name>\n")),(0,o.kt)("p",null,"Or if you're using config file set the ",(0,o.kt)("inlineCode",{parentName:"p"},".compute.provider.cluster")," field to the cluster name you've just provisioned"),(0,o.kt)("h3",{id:"step-7-enjoy"},"Step 7: Enjoy!"),(0,o.kt)("p",null,"Your cluster will be available for use on Grid, so use it ","(","or any other cluster",")"," as you wish."),(0,o.kt)("h2",{id:"editing-and-deleting-clusters"},"Editing and Deleting Clusters"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"grid edit")," to see instance types available and update as necessary."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"grid edit cluster <cluster name>\n")),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"grid delete")," to delete cluster. Deleting a cluster will delete its resources, including runing resources. Use with care!"),(0,o.kt)("note",null,"Grid attempts to delete all cluster resources when a delete operation is initiated. However, sometimes there are dangling resources left behind. Make sure to inspect your account for dangling resources and delete them manually if that is the case. Reach out to support if you have any issues -- we are happy to help!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"grid delete cluster <cluster name>\n")))}m.isMDXComponent=!0},4377:function(e,t,r){t.Z=r.p+"assets/images/aws-add-permissions-736895ac3b3c7377dbf6435435ec3a28.png"},6073:function(e,t,r){t.Z=r.p+"assets/images/aws-create-user-8443fa7d57e7f7db050c9c869160e41d.png"},9744:function(e,t,r){t.Z=r.p+"assets/images/aws-list-users-a9501a83d1c8aa1e2d97c4c4d1fb944b.png"},3462:function(e,t,r){t.Z=r.p+"assets/images/IAM-6ec3d9828b3460cd568fb108bc4e293a.png"}}]);